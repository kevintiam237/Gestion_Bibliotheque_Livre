<UserControl x:Class="Gestion_Bibliotheque_Livre.Views.CategoriesPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:properties="clr-namespace:Gestion_Bibliotheque_Livre.Properties"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800"
             Background="{StaticResource BackgroundGradient}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Style="{StaticResource ContentHeaderStyle}">
            <StackPanel Orientation="Horizontal">
                <Border 
                    Style="{StaticResource HeaderCathegorie}">
                    <TextBlock Text="🏷️"
                               Style="{StaticResource HeaderBooksTextBlock}"/>
                </Border>
                <StackPanel Margin="15,0,0,0">
                    <TextBlock x:Name="TxtCategoriesHeader"
                                Text="{x:Static properties:Resources.Categories}" 
                               Style="{StaticResource ContentTitleStyle}"/>
                    <TextBlock x:Name="TxtManageBookCategories"
                               Text="{x:Static properties:Resources.ManageBookCategorie}" 
                               Style="{StaticResource ContentSubtitleStyle}"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- DataGrid -->
        <Border Grid.Row="1" Style="{StaticResource DataGridContainerStyle}">
            <DataGrid x:Name="DataGridCategories"
                      Style="{StaticResource ModernDataGridStyle}"
                      ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                      RowStyle="{StaticResource DataGridRowStyle}"
                      CellStyle="{StaticResource DataGridCellStyle}"
                      AutoGenerateColumns="False"
                      SelectionChanged="DataGridCategories_SelectionChanged">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="{x:Static properties:Resources.ID}" 
                                       Binding="{Binding Id}" 
                                       Width="80"
                                       ElementStyle="{StaticResource DataGridTextStyle}"/>
                    <DataGridTextColumn 
                                       x:Name="ColCategoryName"
                                       Header="{x:Static properties:Resources.CategoryName}" 
                                       Binding="{Binding Nom}" 
                                       Width="*"
                                       ElementStyle="{StaticResource DataGridTextStyle}"/>
                    <DataGridTextColumn 
                                        x:Name="ColCategoryBooksCount"
                                        Header="{x:Static properties:Resources.BooksCount}" 
                                       Binding="{Binding NombreLivres}" 
                                       Width="200"
                                       ElementStyle="{StaticResource DataGridTextStyle}"/>
                </DataGrid.Columns>

                <!-- Application du style de texte à tous les TextBlocks -->
                <DataGrid.Resources>
                    <Style TargetType="TextBlock" BasedOn="{StaticResource DataGridTextStyle}"/>
                </DataGrid.Resources>
            </DataGrid>
        </Border>

        <!-- Action Panel -->
        <Border Grid.Row="2" Style="{StaticResource ActionPanelStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0"  Style="{StaticResource StatisticsHeaderStyle}">
                    <StackPanel>
                        <TextBlock x:Name="TxtBookDetails"
                                    Style="{StaticResource TextBlockStyle}"
                                    Text="{x:Static properties:Resources.CategoryManagement}" />
                    </StackPanel>
                </Border>
                
                <Border Grid.Row="1" >
                    <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="10">
                        <Label 
                 x:Name="LabelCategoryName"
                 Content="{x:Static properties:Resources.CategoryName}" 
                Style="{StaticResource ModernLabelStyle}"/>
                        <TextBox x:Name="TxtCategoryName" 
                  Style="{StaticResource ModernTextBoxStyle}"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Bottom" Margin="10">
                        <Button x:Name="BtnAddCategory" 
                 Content="{x:Static properties:Resources.Add}" 
                 Style="{StaticResource SuccessButtonStyle}"
                 Click="BtnAddCategory_Click"/>
                        <Button x:Name="BtnEditCategory" 
                 Content="{x:Static properties:Resources.Edit}" 
                 Style="{StaticResource PrimaryButtonStyle}"
                 Click="BtnEditCategory_Click"/>
                        <Button x:Name="BtnDeleteCategory" 
                 Content="{x:Static properties:Resources.Delete}" 
                 Style="{StaticResource DangerButtonStyle}"
                 Click="BtnDeleteCategory_Click"/>
                    </StackPanel>
                </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- Error Message -->
        <Border Grid.Row="3"
                x:Name="ErrorMessageBorder"
                Style="{StaticResource ErrorMessageBorderStyle}"
                Visibility="Collapsed">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="⚠️" Style="{StaticResource ErrorIconTextStyle}"/>
                <TextBlock x:Name="TxtErrorMessage"
                           Text=""
                           Style="{StaticResource ErrorMessageTextStyle}"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>